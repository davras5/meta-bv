<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logisches Datenmodell</title>
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />

    <style>
        /* --- 1. VARIABLES & RESET --- */
        :root {
            --swiss-red: #DC0018;
            --text-black: #222222;
            --text-dark: #333333;
            --text-light: #666666;
            --border: #CCCCCC;
            --bg-gray: #F5F5F5;
            --footer-bg: #454545;
            --link-color: #0066CC; /* Neu: Dunkles Blau für Links */
            --font-stack: "Frutiger", "Helvetica Neue", Helvetica, Arial, sans-serif;
        }

        body { 
            margin: 0; 
            font-family: var(--font-stack); 
            color: var(--text-dark); 
            background: white;
            -webkit-font-smoothing: antialiased;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        * { box-sizing: border-box; }
        a { text-decoration: none; color: inherit; cursor: pointer; }

        .hidden { display: none !important; }

        /* Helper for Icons */
        .material-symbols-rounded {
            font-size: 20px;
            vertical-align: middle;
            user-select: none;
        }

        /* --- 2. LAYOUT UTILITIES & CONTAINERS --- */
        .u-max-width {
            max-width: 1160px;
            margin: 0 auto;
            padding: 0 20px;
            width: 100%;
        }

        .container {
            flex: 1; 
        }

        /* --- 3. HEADER & BRANDING --- */
        header { padding-top: 30px; padding-bottom: 20px; }
        
        .header-inner {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
        }

        .branding { display: flex; align-items: flex-start; gap: 20px; }
        
        /* CSS für das Wappen (MODIFIED to target wrapper and img) */
        .logo-wrapper {
            width: 40px; 
            height: 40px; 
            display: block;
            flex-shrink: 0; /* Verhindert, dass das Logo schrumpft */
        }
        
        /* NEW: Style for the external SVG image */
        .logo-wrapper .logo-img-external {
            width: 100%;
            height: 100%;
            display: block;
            object-fit: contain;
        }

        .branding-text {
            border-left: 1px solid #999;
            padding-left: 20px;
            font-size: 16px;
            line-height: 1.3;
        }
        .branding-text strong { display: block; font-weight: 700; color: var(--text-black); }
        .branding-text span { display: block; color: var(--text-black); font-size: 15px; }

        .top-meta { 
            font-size: 14px; 
            display: flex; 
            gap: 25px; 
            color: var(--text-black);
            align-items: center; 
        }
        
        .lang-selector { 
            font-weight: 400; 
            display: flex; 
            align-items: center; 
            gap: 2px; 
            cursor: pointer; 
        }
        .lang-selector .material-symbols-rounded { font-size: 18px; }

        /* --- 4. NAVIGATION TABS --- */
        .nav-tabs {
            margin-top: 45px;
            border-bottom: 1px solid #E5E5E5;
            display: flex;
            gap: 35px;
        }
        .nav-link {
            padding-bottom: 15px;
            font-size: 16px;
            color: var(--text-black);
            position: relative;
            cursor: pointer;
        }
        .nav-link.active {
            font-weight: bold;
            color: var(--swiss-red);
            border-bottom: 4px solid var(--swiss-red);
            margin-bottom: -1px;
        }

        /* --- 5. BREADCRUMBS & ACTION ICONS --- */
        .sub-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 0;
        }
        .breadcrumbs { font-size: 14px; color: var(--text-light); }
        .breadcrumbs span { margin: 0 8px; color: #999; }
        .breadcrumbs a:hover { text-decoration: underline; }

        .action-icons { display: flex; gap: 12px; color: #666; }
        .icon-btn { 
            cursor: pointer; 
            padding: 8px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }
        .icon-btn:hover { background-color: #F5F5F5; color: var(--swiss-red); }
        .icon-btn .material-symbols-rounded { font-size: 22px; }

        /* --- 6. PAGE TITLE & CONTROLS --- */
        h1.page-title {
            font-size: 34px;
            font-weight: 400;
            margin: 10px 0 40px 0;
            color: var(--text-black);
        }
        
        /* --- 10. Heading Unification (New) --- */
        .page-title-h2 {
            font-size: 34px !important;
            font-weight: 400 !important;
            margin: 10px 0 40px 0 !important;
            color: var(--text-black) !important;
        }

        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
        }
        .search-group { display: flex; gap: 15px; width: 100%; max-width: 500px; }
        .input-wrapper { position: relative; flex-grow: 1; }
        .input-wrapper input {
            width: 100%; padding: 10px 15px 10px 48px;
            border: 1px solid #999; border-radius: 3px; font-size: 16px; height: 46px;
        }
        .search-icon {
            position: absolute; left: 14px; top: 50%; transform: translateY(-50%);
            color: #666; pointer-events: none; font-size: 22px;
        }
        
        .btn-filter {
            height: 46px; padding: 0 24px; background: white;
            border: 1px solid #333; border-radius: 3px;
            font-size: 15px; font-weight: bold;
            display: flex; align-items: center; gap: 8px; cursor: pointer;
        }
        .btn-filter .material-symbols-rounded { font-size: 20px; }

        .view-toggles { display: flex; gap: 10px; }
        .toggle-icon {
            width: 46px; height: 46px; background: #999;
            display: flex; align-items: center; justify-content: center;
            color: white; border-radius: 3px; cursor: pointer;
            transition: background-color 0.2s;
        }
        .toggle-icon:hover { opacity: 0.8; }
        .toggle-icon.active { background: #666; color: white; pointer-events: none; }
        .toggle-icon.inactive { background: white; color: #333; border: 1px solid #ccc; }

        /* --- 7. CARD/TAGS/DETAIL --- */
        .grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin-bottom: 80px;
        }
        @media (max-width: 1000px) { .grid { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 600px) { .grid { grid-template-columns: 1fr; } }

        .card {
            background: white;
            border: 1px solid #E5E5E5;
            border-radius: 4px;
            overflow: hidden;
            display: flex; flex-direction: column;
            box-shadow: 0 2px 5px rgba(0,0,0,0.02);
            transition: all 0.2s;
            cursor: pointer;
        }
        .card:hover {
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            transform: translateY(-3px);
            border-color: #ccc;
        }
        .card-img-wrap { height: 220px; position: relative; background: #eee; }
        .card-img { width: 100%; height: 100%; object-fit: cover; }
        .tags-overlay { position: absolute; top: 20px; left: 20px; display: flex; gap: 10px; }
        
        /* === UNIVERSAL TAG PILL STYLE === */
        .tag-pill {
            background: white;
            border: 1px solid #999;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 13px;
            color: #444;
            font-weight: 400;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            white-space: nowrap;
            transition: all 0.2s ease;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        .tag-pill:hover {
            background-color: #E5E5E5;
            border-color: #666;
            color: #000;
        }

        .card-body { padding: 30px; display: flex; flex-direction: column; flex-grow: 1; }
        h3.card-title { 
            font-size: 20px; font-weight: 700; margin: 0 0 15px 0; color: var(--text-black); 
        }
        p.card-desc { 
            font-size: 16px; line-height: 1.5; color: var(--text-black); margin: 0 0 35px 0; flex-grow: 1; 
        }
        .card-footer { display: flex; justify-content: space-between; align-items: flex-end; }
        .tags-bottom { display: flex; flex-wrap: wrap; gap: 8px; }

        .btn-arrow {
            width: 40px; height: 40px; border: 1px solid #E5E5E5; border-radius: 2px;
            display: flex; align-items: center; justify-content: center;
            color: var(--swiss-red); flex-shrink: 0; transition: all 0.2s;
        }
        .btn-arrow:hover { border-color: var(--swiss-red); background: var(--swiss-red); color: white; }

        /* --- 8. LIST VIEW --- */
        .list-table { width: 100%; border-collapse: collapse; font-size: 15px; margin-bottom: 80px; }
        .list-table th {
            text-align: left; background: #F2F4F5; padding: 15px;
            color: #666; font-size: 13px; font-weight: 700; text-transform: uppercase;
        }
        .list-table td { padding: 20px 15px; border-bottom: 1px solid #E5E5E5; vertical-align: middle; }
        .list-table tbody tr { cursor: pointer; transition: background-color 0.1s; }
        .list-table tbody tr:hover { background-color: #F2F4F5; }
        
        .col-title { font-weight: 700; font-size: 16px; color: var(--text-black); width: 25%; }
        .col-desc { color: var(--text-black); line-height: 1.5; }
        .col-tags { width: 30%; text-align: right; }

        /* --- DETAIL VIEW SPECIFIC & CONTENT LINKS (NEW) --- */
        
        /* Links in statischem Content und Detailansicht hervorheben */
        #view-about a:not(.footer-link), 
        #view-handbuch a:not(.footer-link),
        #view-detail a:not(.footer-link) {
            color: var(--link-color);
            text-decoration: underline;
        }
        #view-about a:not(.footer-link):hover,
        #view-handbuch a:not(.footer-link):hover,
        #view-detail a:not(.footer-link):hover {
            text-decoration: none;
        }


        .detail-hero { display: flex; gap: 50px; margin-bottom: 60px; margin-top: 20px; }
        .detail-info { flex: 1; }
        .detail-image-box { flex: 1; max-width: 600px; }
        .detail-image-box img { width: 100%; height: auto; border-radius: 2px; }
        .detail-tags { display: flex; gap: 10px; margin-bottom: 25px; }
        #detail-desc { font-size: 18px; line-height: 1.6; margin-bottom: 30px; }

        .responsible-box {
            background: #F5F5F5; padding: 30px; margin: 50px 0; border-left: 5px solid #ddd;
        }
        .box-title { font-weight: bold; margin-bottom: 8px; font-size: 18px; }
        .box-text { font-size: 16px; font-style: italic; color: #666; }

        .section-title { font-size: 24px; font-weight: 400; margin: 50px 0 25px 0; }
        
        .meta-list { border-top: 1px solid #E5E5E5; }
        .meta-row {
            display: flex; padding: 16px 15px; border-bottom: 1px solid #E5E5E5;
            font-size: 16px; align-items: center; transition: background-color 0.1s;
        }
        .meta-row:hover { background-color: #F2F4F5; }
        .meta-key { width: 280px; font-weight: 400; flex-shrink: 0; color: var(--text-black); }
        .meta-val { color: #333; display: flex; align-items: center; line-height: 1.5; }
        
        /* Attributes Table */
        .attr-table { width: 100%; border-collapse: collapse; font-size: 15px; margin-top: 20px; }
        .attr-table th {
            text-align: left; background: #F2F4F5; padding: 16px;
            color: #666; font-size: 13px; font-weight: 700; text-transform: uppercase;
        }
        .attr-table td { padding: 16px; border-bottom: 1px solid #E5E5E5; vertical-align: top; line-height: 1.5; }
        .attr-table tbody tr:hover { background-color: #F2F4F5; }
        
        /* --- ABOUT & HANDBUCH VIEW SPECIFIC --- */
        #view-about, #view-handbuch { padding-bottom: 80px; }
        /* Style für nachfolgende H2 */
        #view-about h2, #view-handbuch h2 { 
            font-size: 28px; 
            font-weight: 700; 
            margin-top: 50px; 
            margin-bottom: 20px; 
        }
        #view-about h3, #view-handbuch h3 { font-size: 24px; font-weight: 700; margin-top: 40px; margin-bottom: 15px; }
        #view-about p, #view-handbuch p { font-size: 16px; line-height: 1.6; margin-bottom: 20px; }
        #view-about ul, #view-handbuch ul { list-style-type: disc; padding-left: 25px; margin-bottom: 20px; }
        #view-about li, #view-handbuch li { font-size: 16px; line-height: 1.6; margin-bottom: 8px; }
        #view-about strong, #view-handbuch strong { font-weight: 700; }
        #view-about .info-link, #view-handbuch .info-link { margin-top: 30px; }

        /* Spezifische Styling für das Bild im Handbuch */
        .handbuch-img {
            display: block;
            max-width: 100%;
            height: auto;
            margin: 30px 0;
            border: 1px solid #E5E5E5;
            border-radius: 4px;
        }


        /* --- 9. FOOTER --- */
        footer {
            background-color: var(--footer-bg);
            color: white;
            height: 40px;
            margin-top: auto;
            display: flex;
            align-items: center;
        }
        .footer-inner {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
        }
        .footer-left {
            display: flex;
            gap: 30px;
        }
        .footer-link {
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .footer-link:hover { text-decoration: underline; }
        .footer-link .material-symbols-rounded { font-size: 16px; }
        .footer-right {
            color: #ccc;
        }

    </style>
</head>
<body>

    <div class="container u-max-width">
        <header>
            <div class="header-inner">
                <div class="branding">
                    <div class="logo-wrapper">
                        <img src="https://raw.githubusercontent.com/davras5/meta-bv/212ee3a88abba781fd699543b02df718e68fde63/Coat_of_arms_of_Switzerland.svg.png" alt="Wappen der Schweiz" class="logo-img-external">
                    </div>
                    <div class="branding-text">
                        <strong>Bundesamt für Bauten und Logistik BBL</strong>
                        <span>Bereich Bauten</span>
                        <span>Datenkatalog</span>
                    </div>
                </div>
                <div class="top-meta">
                    <a href="#">Kontakt</a>
                    <a href="#">Export</a>
                    <div class="lang-selector">DE <span class="material-symbols-rounded">expand_more</span></div>
                </div>
            </div>

            <div class="nav-tabs" id="nav-tabs">
                <div id="tab-model" class="nav-link active" data-page="model">Logisches Datenmodell</div>
                <div id="tab-about" class="nav-link" data-page="about">Über diesen Datenkatalog</div>
                <div id="tab-handbuch" class="nav-link" data-page="handbuch">Handbuch</div>
            </div>
        </header>

        <div class="sub-header">
            <div class="breadcrumbs" id="breadcrumbs">
                Startseite <span>></span> Logisches Datenmodell
            </div>
            <div class="action-icons">
                <div class="icon-btn" title="Print"><span class="material-symbols-rounded">print</span></div>
                <div class="icon-btn" title="Share"><span class="material-symbols-rounded">share</span></div>
            </div>
        </div>

        <main>
            <div id="view-catalog">
                <h1 class="page-title">Logisches Datenmodell</h1>
                
                <div class="toolbar">
                    <div class="search-group">
                        <div class="input-wrapper">
                            <span class="material-symbols-rounded search-icon">search</span>
                            <input type="text" id="searchInput" placeholder="Suchen">
                        </div>
                        <button class="btn-filter">
                            <span class="material-symbols-rounded">filter_list</span>
                            Filter anzeigen
                        </button>
                    </div>
                    <div class="view-toggles">
                        <div id="btn-grid" class="toggle-icon active" data-view="grid">
                            <span class="material-symbols-rounded">grid_view</span>
                        </div>
                        <div id="btn-list" class="toggle-icon inactive" data-view="list">
                            <span class="material-symbols-rounded">view_list</span>
                        </div>
                    </div>
                </div>

                <div id="grid-container" class="grid"></div>

                <table id="list-container" class="list-table hidden">
                    <thead>
                        <tr>
                            <th>KONZEPT</th>
                            <th>BESCHREIBUNG</th>
                            <th style="text-align:right">SCHLÜSSELWÖRTER</th>
                        </tr>
                    </thead>
                    <tbody id="list-body"></tbody>
                </table>
            </div>

            <div id="view-detail" class="hidden">
                <h1 class="page-title" id="detail-title">Title</h1>
                
                <div class="detail-hero">
                    <div class="detail-info">
                        <div class="detail-tags" id="detail-tags"></div>
                        <p id="detail-desc">Desc</p>
                    </div>
                    <div class="detail-image-box">
                        <img id="detail-img" src="" alt="">
                    </div>
                </div>

                <div class="responsible-box">
                    <div class="box-title">Verantwortliche Person</div>
                    <div class="box-text">Niemand fühlt sich für diesen Datensatz zuständig – höchste Zeit, jemandem diese Ehre zu erteilen!</div>
                </div>

                <h3 class="section-title">Metadaten</h3>
                <div class="meta-list" id="meta-list"></div>

                <h3 class="section-title">Standards</h3>
                <div class="meta-list" id="standards-list"></div>

                <h3 class="section-title">Attribute</h3>
                <table class="attr-table">
                    <thead>
                        <tr>
                            <th style="width:20%">NAME</th>
                            <th style="width:15%">FORMAT</th>
                            <th style="width:10%">SCHLÜSSEL</th>
                            <th style="width:15%">WERTELISTE</th>
                            <th>BESCHREIBUNG</th>
                        </tr>
                    </thead>
                    <tbody id="attr-body"></tbody>
                </table>
                <div style="height:100px;"></div>
            </div>

            <div id="view-about" class="hidden">
                <h1 class="page-title">Über diesen Datenkatalog</h1>
                </div>

             <div id="view-handbuch" class="hidden">
                <h1 class="page-title">Handbuch</h1>
                </div>
        </main>
    </div>

    <footer>
        <div class="footer-inner u-max-width">
            <div class="footer-left">
                <a href="https://www.admin.ch/gov/de/start/rechtliches.html" target="_blank" class="footer-link">
                    <span class="material-symbols-rounded">open_in_new</span>
                    Rechtliche Grundlagen
                </a>
                <a href="https://github.com/davras5/meta-bv/" target="_blank" class="footer-link">
                    <span class="material-symbols-rounded">open_in_new</span>
                    Quellcode (GitHub)
                </a>
            </div>
            <div class="footer-right">
                Version 1.0.0
            </div>
        </div>
    </footer>

    <script>
        // === DATEN & KONSTANTEN ===
        const ABOUT_CONTENT = `
            <h2 class="page-title-h2">Was ist ein Datenkatalog?</h2> 
            <p>Ein Metadatenkatalog ist die gemeinsame Sprache für die Daten einer Organisation. Im Immobilienmanagement des Bundes arbeiten verschiedene Abteilungen und Systeme oft mit unterschiedlichen Begriffen für dieselben Konzepte. Diese fehlende Standardisierung verhindert Interoperabilität und erschwert die Zusammenarbeit. Der Metadatenkatalog etabliert einheitliche Standards und Definitionen für alle Geschäftsobjekte und dokumentiert transparent deren Zusammenhänge, Verantwortlichkeiten und Nutzungsmöglichkeiten. Als zentrale Referenz schafft er die Grundlage für eine vernetzte Datenbewirtschaftung in der Bundesverwaltung.</p>
            
            <h2>Wieso ist das für uns relevant?</h2>
            <p>Das BBL verwaltet das Immobilienportfolio des Bundes mit tausenden von Datenelementen aus verschiedensten Fachanwendungen. Die manuelle Dokumentation dieser komplexen Datenlandschaft ist nicht mehr beherrschbar. Gleichzeitig verlangen regulatorische Anforderungen (DSG, EMBAV, ISG, BGÖ) lückenlose Nachweise über unsere Datenverarbeitungen. Ohne systematische Metadatenverwaltung werden Compliance-Risiken unkalkulierbar und das Once-Only-Prinzip bleibt unerreichbar.</p>
            
            <h2>Was sind die Ziele dieses Metadatenkatalogs?</h2>
            <ul>
                <li><strong>Dreistufiges Metadatenmodell:</strong> Klare Trennung zwischen fachlichen Geschäftsobjekten, Datenmodellierung und technischer Implementierung nach TOGAF-Standard</li>
                <li><strong>Business-freundliche Oberfläche:</strong> Verständliche Darstellung ohne technische Komplexität bei voller Integration mit Innovator EA im Hintergrund</li>
                <li><strong>Automatisierte Prozesse:</strong> API-getriebene Verwaltung für Import, Export und Massenmutationen</li>
                <li><strong>Compliance-Instrument:</strong> Automatisierte Nachweise für gesetzliche Anforderungen auf Knopfdruck</li>
                <li><strong>Nationale Integration:</strong> Synchronisation mit i14y, opendata.swiss, simap.ch und TERMDAT</li>
                <li><strong>Data Governance:</strong> Eindeutige Rollen und Verantwortlichkeiten für jeden Datensatz</li>
            </ul>
            
            <h2>Wer profitiert von einem Metadatenkatalog?</h2>
            <ul>
                <li><strong>Fachbereiche:</strong> Verständliche Dokumentation ihrer Geschäftsobjekte und klare Ansprechpartner</li>
                <li><strong>IT-Architekten:</strong> Effiziente Verwaltung von Datenmodellen und Standards</li>
                <li><strong>IT-Teams:</strong> Präzise technische Spezifikationen für Systemintegrationen</li>
                <li><strong>Compliance:</strong> Automatisierte Berichte für Audits und Datenschutzbeauftragte</li>
                <li><strong>Führung:</strong> Transparente Entscheidungsgrundlagen basierend auf verlässlichen Metadaten</li>
                <li><strong>Externe Partner:</strong> Standardisierter Zugang zu öffentlichen Immobilien- und Beschaffungsdaten</li>
            </ul>

            <h2>Nächste Schritte</h2>
            <p>Wir werden den Katalog weiter verfeinern, indem wir uns an die Dateneigentümer wenden, bestehende Einträge aktualisieren und die Integration mit anderen Plattformen prüfen. Mit der Zeit wollen wir dieses Tool zu einer unverzichtbaren Ressource für interne und externe Partner machen, die datengesteuerte Innovationen in allen Bereichen ermöglicht.</p>

            <h3>Weitere Informationen</h3>
            <div class="info-link">
                <a href="https://confluence-link-to-fachkonzept" target="_blank" class="footer-link" style="color:var(--text-black);">
                    <span class="material-symbols-rounded">open_in_new</span>
                    Fachkonzept Metadatenmanagement IMMO (Confluence)
                </a>
            </div>
        `;

        const HANDBUCH_CONTENT = `
            <h2 class="page-title-h2">Das Metadatenmodell</h2>
            <p>Das Metadatenmodell des BBL-Immobilienkatalogs basiert auf dem Swiss DCAT Application Profile (DCAT-AP CH v3.0.0) und erweitert dieses minimal um spezifische Komponenten für die Verwaltung von Immobiliendaten des Bundes.</p>
            
            <h3>Kernarchitektur</h3>
            <p>Das Modell besteht aus fünf DCAT-Hauptklassen und einer BBL-spezifischen Erweiterung:</p>
            
            <p><strong>DCAT-Standardklassen:</strong></p>
            <ul>
                <li><strong>dcat:Catalog</strong> - BBL-Immobilienkatalog als Gesamtverzeichnis</li>
                <li><strong>dcat:Dataset</strong> - Immobiliendatensammlungen (Gebäudestammdaten, Energiedaten)</li>
                <li><strong>dcat:DatasetSeries</strong> - Zeitreihen (Jahresberichte, Kostenentwicklungen)</li>
                <li><strong>dcat:Distribution</strong> - Bereitstellungsformen (Excel, API, PDF)</li>
                <li><strong>dcat:DataService</strong> - Datendienste (SAP-Schnittstellen, REST-APIs)</li>
            </ul>
            
            <p><strong>Schema-Modellierung (DCAT-konform):</strong></p>
            <ul>
                <li><strong>dct:Standard</strong> - Geschäftsobjekt-Schema (Gebäude, Grundstück, Mietvertrag)</li>
                <li><strong>skos:ConceptScheme</strong> - Kontrollierte Vokabulare und Wertelisten (Gebäudetypen, Kantone)</li>
                <li><strong>skos:Concept</strong> - Einzelne Werte in Wertelisten</li>
            </ul>
            
            <p><strong>BBL-spezifische Erweiterung:</strong></p>
            <ul>
                <li><strong>bv:Attribute</strong> - Datenfelder mit Typdefinitionen, Validierungsregeln und Wertelisten-Referenzen</li>
            </ul>

            <img src="BBL DCAT-AP CH.avif" alt="Diagramm des BBL DCAT-AP CH Metadatenmodells" class="handbuch-img">
            
            <h3>Geschäftsobjekt-Modellierung</h3>
            <pre style="background:#f2f2f2; padding:15px; border:1px solid #ddd; font-size:14px; overflow-x:auto; color:#444;">
dct:Standard "Gebäude-Schema"
├── dct:identifier: "STD-001"
├── dct:title: "Gebäude"@de, "Bâtiment"@fr, "Edificio"@it
├── dct:description: Definition gemäss KBOB/TERMDAT
├── bv:hasAttribute:
│   ├── bv:Attribute "Baujahr"
│   │   ├── dct:type: "xsd:gYear"
│   │   ├── dct:required: true
│   │   └── dct:conformsTo → skos:ConceptScheme "Jahre"
│   └── bv:Attribute "Gebäudetyp"
│       └── dct:conformsTo → skos:ConceptScheme "Gebäudetypen"
└── dcat:version: "3.0.0"
            </pre>

            <h3>Versionierung</h3>
            <p>Alle Elemente unterstützen vollständige Versionskontrolle:</p>
            <ul>
                <li><strong>dcat:version</strong> - Semantische Versionierung (MAJOR.MINOR.PATCH)</li>
                <li><strong>dct:issued</strong> - Erstveröffentlichung</li>
                <li><strong>dct:modified</strong> - Letzte Änderung</li>
                <li><strong>adms:versionNotes</strong> - Änderungsbeschreibung</li>
                <li><strong>dcat:previousVersion</strong> - Verweis auf Vorgängerversion</li>
            </ul>

            <h3>Governance und Zugriffssteuerung</h3>
            <p><strong>Rollenmodell:</strong></p>
            <ul>
                <li><strong>bv:dataOwner</strong> (foaf:Agent) - Fachverantwortlicher Immobilienmanagement</li>
                <li><strong>bv:dataSteward</strong> (foaf:Agent) - Datenarchitekt/Datenmanager</li>
                <li><strong>bv:dataCustodian</strong> (foaf:Agent) - Technischer Systembetreuer</li>
            </ul>
            
            <p><strong>Zugriffsrechte und Compliance:</strong></p>
            <ul>
                <li><strong>dct:accessRights</strong> - Zugriffsbeschränkungen (öffentlich/intern/vertraulich)</li>
                <li><strong>dct:license</strong> - Nutzungsbedingungen</li>
                <li><strong>bv:dsgCategory</strong> - DSG-Klassifizierung</li>
                <li><strong>bv:isgClassification</strong> - Informationssicherheitsstufe</li>
                <li><strong>dcatap:applicableLegislation</strong> - Rechtliche Grundlagen (EMBAG, DSG)</li>
            </ul>

            <h3>Strukturbeispiel</h3>
            <pre style="background:#f2f2f2; padding:15px; border:1px solid #ddd; font-size:14px; overflow-x:auto; color:#444;">
BBL Immobilienkatalog (dcat:Catalog)
├── Geschäftsobjekt-Schemas (Konzeptuelle Ebene)
│   ├── dct:Standard "Gebäude-Schema" v3.0.0
│   └── dct:Standard "Grundstück-Schema" v2.1.0
│
├── Datenattribute (Logische Ebene)
│   ├── bv:Attribute "EGID" (required, unique)
│   └── bv:Attribute "Nutzfläche" (decimal, m²)
│
├── Wertelisten (Referenzdaten)
│   ├── skos:ConceptScheme "Gebäudetypen" v2.1.0
│   └── skos:ConceptScheme "Kantone" v1.0.0
│
└── Datasets (Physische Ebene)
    ├── dcat:Dataset "Gebäudestammdaten 2025"
    │   └── dcat:Distribution (SAP-Export, REST-API)
    └── dcat:DataService "IMMO-API v2"
            </pre>
            <p>Diese Struktur ermöglicht die vollständige Nachvollziehbarkeit der Datenherkunft, klare Verantwortlichkeiten und erfüllt alle regulatorischen Anforderungen der Bundesverwaltung.</p>

            <h3>Weiterführende Informationen und Standards</h3>
            <p><strong>Verwendete Standards und Spezifikationen:</strong></p>
            <ul>
                <li><strong>DCAT v3 (W3C Recommendation)</strong><br>Die Basis unseres Metadatenmodells. Besonders relevant sind die Qualified Forms für erweiterte Beziehungen:<br><a href="https://www.w3.org/TR/vocab-dcat-3/#qualified-forms" target="_blank" style="text-decoration:underline;">https://www.w3.org/TR/vocab-dcat-3/#qualified-forms</a></li>
                
                <li><strong>Dublin Core Metadata Terms</strong><br>Definiert zentrale Properties wie dct:Standard, dct:conformsTo und dct:identifier:<br><a href="https://www.dublincore.org/specifications/dublin-core/dcmi-terms/#Standard" target="_blank" style="text-decoration:underline;">https://www.dublincore.org/specifications/dublin-core/dcmi-terms/#Standard</a></li>
                
                <li><strong>DCAT-AP CH (eCH-0200)</strong><br>Der Schweizer Anwendungsstandard für Datenportale der Bundesverwaltung:<br><a href="https://ech.ch/de/ech/ech-0200/3.0" target="_blank" style="text-decoration:underline;">https://ech.ch/de/ech/ech-0200/3.0</a><br><a href="https://www.dcat-ap.ch/" target="_blank" style="text-decoration:underline;">https://www.dcat-ap.ch/</a></li>
                
                <li><strong>SKOS (Simple Knowledge Organization System)</strong><br>Für die Modellierung von Wertelisten und kontrollierten Vokabularen:<br><a href="https://www.w3.org/TR/skos-reference/" target="_blank" style="text-decoration:underline;">https://www.w3.org/TR/skos-reference/</a></li>
            </ul>

            <p><strong>Governance-Rollen gemäss NaDB</strong></p>
            <p>Die Rollendefinitionen basieren auf der Nationalen Datenbewirtschaftung des BFS:</p>
            <ul>
                <li><strong>Data Owner</strong> - Fachliche Verantwortung</li>
                <li><strong>Data Steward</strong> - Datenarchitektur und -qualität</li>
                <li><strong>Data Custodian</strong> - Technischer Betrieb</li>
            </ul>
            
            <p><strong>Zugriffsrechte und Compliance:</strong></p>
            <ul>
                <li><strong>dct:accessRights</strong> - Zugriffsbeschränkungen (öffentlich/intern/vertraulich)</li>
                <li><strong>dct:license</strong> - Nutzungsbedingungen</li>
                <li><strong>bv:dsgCategory</strong> - DSG-Klassifizierung</li>
                <li><strong>bv:isgClassification</strong> - Informationssicherheitsstufe</li>
                <li><strong>dcatap:applicableLegislation</strong> - Rechtliche Grundlagen (EMBAG, DSG)</li>
            </ul>

            <h3>Strukturbeispiel</h3>
            <pre style="background:#f2f2f2; padding:15px; border:1px solid #ddd; font-size:14px; overflow-x:auto; color:#444;">
BBL Immobilienkatalog (dcat:Catalog)
├── Geschäftsobjekt-Schemas (Konzeptuelle Ebene)
│   ├── dct:Standard "Gebäude-Schema" v3.0.0
│   └── dct:Standard "Grundstück-Schema" v2.1.0
│
├── Datenattribute (Logische Ebene)
│   ├── bv:Attribute "EGID" (required, unique)
│   └── bv:Attribute "Nutzfläche" (decimal, m²)
│
├── Wertelisten (Referenzdaten)
│   ├── skos:ConceptScheme "Gebäudetypen" v2.1.0
│   └── skos:ConceptScheme "Kantone" v1.0.0
│
└── Datasets (Physische Ebene)
    ├── dcat:Dataset "Gebäudestammdaten 2025"
    │   └── dcat:Distribution (SAP-Export, REST-API)
    └── dcat:DataService "IMMO-API v2"
            </pre>
            <p>Diese Struktur ermöglicht die vollständige Nachvollziehbarkeit der Datenherkunft, klare Verantwortlichkeiten und erfüllt alle regulatorischen Anforderungen der Bundesverwaltung.</p>
        `;


        // === JS OPTIMIERUNG: Kapselung in IIFE ===
        (function() {
            let db = [];
            let currentView = 'grid'; // 'grid' or 'list'
            let currentFilter = '';
            let currentPage = 'model'; // 'model', 'about', or 'handbuch'

            // 1. Initialize & Event Listener Setup
            async function init() {
                try {
                    const res = await fetch('data.json');
                    db = await res.json();
                    
                    // Pre-render static content
                    document.getElementById('view-about').innerHTML = ABOUT_CONTENT;
                    document.getElementById('view-handbuch').innerHTML = HANDBUCH_CONTENT;

                    // Event-Listener für das Routing einrichten
                    window.addEventListener('hashchange', handleRoute);
                    handleRoute(); // Initial load

                    // Event-Listener für Navigation Tabs
                    document.querySelectorAll('.nav-tabs .nav-link').forEach(tab => {
                        tab.addEventListener('click', (e) => {
                            const page = e.currentTarget.dataset.page;
                            window.location.hash = `#/${page}`;
                        });
                    });

                    // Event-Listener für View Toggles
                    document.querySelectorAll('.view-toggles .toggle-icon').forEach(btn => {
                        btn.addEventListener('click', (e) => {
                            switchView(e.currentTarget.dataset.view);
                        });
                    });

                    // Event-Listener für Suche
                    const searchInput = document.getElementById('searchInput');
                    if(searchInput) {
                        searchInput.addEventListener('input', (e) => {
                            currentFilter = e.target.value.toLowerCase();
                            renderCurrentView();
                        });
                    }

                } catch (e) {
                    console.error("Daten-Load fehlgeschlagen oder Parsing-Fehler: data.json muss existieren und gültiges JSON sein.", e);
                }
            }

            // 2. Routing
            function handleRoute() {
                const hash = window.location.hash;
                if (hash.startsWith('#/detail/')) {
                    const id = hash.split('/')[2];
                    renderDetail(id);
                } else if (hash.startsWith('#/about')) {
                    navigate('about');
                } else if (hash.startsWith('#/handbuch')) {
                    navigate('handbuch');
                } else {
                    navigate('model');
                }
            }

            function setBreadcrumbs(page, title) {
                const breadcrumbsEl = document.getElementById('breadcrumbs');
                if (!breadcrumbsEl) return; 

                let breadcrumbsHtml = `<a href="#/model">Startseite</a> <span>></span> `;
                
                if (page === 'model') {
                    breadcrumbsHtml += `Logisches Datenmodell`;
                } else if (page === 'about') {
                    breadcrumbsHtml += `Über diesen Datenkatalog`;
                } else if (page === 'handbuch') {
                    breadcrumbsHtml += `Handbuch`;
                } else if (page === 'detail') {
                    breadcrumbsHtml += `<a href="#/model">Logisches Datenmodell</a> <span>></span> ${title}`;
                }

                breadcrumbsEl.innerHTML = breadcrumbsHtml;
            }

            function navigate(page, itemTitle = null) {
                currentPage = page;

                // Update tab highlighting
                document.querySelectorAll('.nav-link').forEach(tab => tab.classList.remove('active'));
                if (page === 'model' || page === 'detail') {
                    const modelTab = document.getElementById('tab-model');
                    if (modelTab) modelTab.classList.add('active');
                } else {
                    const specificTab = document.getElementById(`tab-${page}`);
                    if (specificTab) specificTab.classList.add('active');
                }

                // Hide all main content views
                const views = ['view-catalog', 'view-detail', 'view-about', 'view-handbuch'];
                views.forEach(id => {
                    const view = document.getElementById(id);
                    if (view) view.classList.add('hidden');
                });
                
                // Show relevant view and update breadcrumbs/toolbar
                const toolbar = document.querySelector('.toolbar');
                const actionIcons = document.querySelector('.action-icons');

                if (page === 'model') {
                    document.getElementById('view-catalog')?.classList.remove('hidden');
                    if (toolbar) toolbar.style.display = 'flex';
                    if (actionIcons) actionIcons.style.display = 'flex';
                    setBreadcrumbs('model');
                    renderCurrentView();
                } else if (page === 'about') {
                    document.getElementById('view-about')?.classList.remove('hidden');
                    if (toolbar) toolbar.style.display = 'none';
                    if (actionIcons) actionIcons.style.display = 'flex';
                    setBreadcrumbs('about');
                } else if (page === 'handbuch') {
                    document.getElementById('view-handbuch')?.classList.remove('hidden');
                    if (toolbar) toolbar.style.display = 'none';
                    if (actionIcons) actionIcons.style.display = 'flex';
                    setBreadcrumbs('handbuch');
                }
            }

            // 3. View Switching Logic 
            function switchView(view) {
                currentView = view;
                
                // Update Toggle Buttons styling
                const gridBtn = document.getElementById('btn-grid');
                const listBtn = document.getElementById('btn-list');

                if(gridBtn && listBtn) {
                    if(view === 'grid') {
                        gridBtn.className = 'toggle-icon active';
                        listBtn.className = 'toggle-icon inactive';
                        document.getElementById('grid-container')?.classList.remove('hidden');
                        document.getElementById('list-container')?.classList.add('hidden');
                    } else {
                        gridBtn.className = 'toggle-icon inactive';
                        listBtn.className = 'toggle-icon active';
                        document.getElementById('grid-container')?.classList.add('hidden');
                        document.getElementById('list-container')?.classList.remove('hidden');
                    }
                }
                renderCurrentView();
            }

            function renderCurrentView() {
                const filtered = db.filter(i => 
                    i.title.toLowerCase().includes(currentFilter) ||
                    i.description.toLowerCase().includes(currentFilter) ||
                    (i.topTags || []).some(t => t.toLowerCase().includes(currentFilter)) ||
                    (i.bottomTags || []).some(t => t.toLowerCase().includes(currentFilter))
                );
                
                if (currentView === 'grid') {
                    renderGrid(filtered);
                } else {
                    renderList(filtered);
                }
            }

            // 4. Render Grid (Cards)
            function renderGrid(items) {
                const container = document.getElementById('grid-container');
                if (!container) return;

                container.innerHTML = items.map(item => `
                    <div class="card" data-id="${item.id}">
                        <div class="card-img-wrap">
                            <img src="${item.image}" class="card-img">
                            <div class="tags-overlay">
                                ${(item.topTags || []).map(t => `<span class="tag-pill">${t}</span>`).join('')}
                            </div>
                        </div>
                        <div class="card-body">
                            <h3 class="card-title">${item.title}</h3>
                            <p class="card-desc">${item.description}</p>
                            <div class="card-footer">
                                <div class="tags-bottom">
                                    ${(item.bottomTags || []).slice(0, 3).map(t => `<span class="tag-pill">${t}</span>`).join('')}
                                </div>
                                <div class="btn-arrow">
                                    <span class="material-symbols-rounded">arrow_forward</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');

                container.querySelectorAll('.card').forEach(card => {
                    card.addEventListener('click', (e) => {
                        window.location.hash = `#/detail/${e.currentTarget.dataset.id}`;
                    });
                });
            }

            // 5. Render List (Table)
            function renderList(items) {
                const tbody = document.getElementById('list-body');
                if (!tbody) return;

                tbody.innerHTML = items.map(item => {
                    const allTags = [...(item.topTags || []), ...(item.bottomTags || [])];
                    
                    return `
                    <tr data-id="${item.id}">
                        <td class="col-title">${item.title}</td>
                        <td class="col-desc">${item.description}</td>
                        <td class="col-tags">
                            ${allTags.map(t => `<span class="tag-pill" style="margin-left:5px; margin-bottom:5px;">${t}</span>`).join('')}
                        </td>
                    </tr>
                `}).join('');

                tbody.querySelectorAll('tr').forEach(row => {
                    row.addEventListener('click', (e) => {
                        window.location.hash = `#/detail/${e.currentTarget.dataset.id}`;
                    });
                });
            }

            // 6. Detail View Renderer
            function renderDetail(id) {
                const item = db.find(x => x.id === id);
                if (!item) return navigate('model');

                // Toggle Views
                document.getElementById('view-catalog')?.classList.add('hidden');
                document.getElementById('view-detail')?.classList.remove('hidden');
                document.getElementById('view-about')?.classList.add('hidden');
                document.getElementById('view-handbuch')?.classList.add('hidden');

                document.querySelector('.toolbar').style.display = 'none';
                document.querySelector('.action-icons').style.display = 'flex';
                
                setBreadcrumbs('detail', item.title);

                // Update Content
                document.getElementById('detail-title').textContent = item.title;
                document.getElementById('detail-desc').textContent = item.fullDescription || item.description;
                document.getElementById('detail-img').src = item.image || ''; // Fallback for image

                const tagsContainer = document.getElementById('detail-tags');
                if (tagsContainer) {
                    tagsContainer.innerHTML = [
                        ...(item.topTags || []), 
                        ...(item.bottomTags || [])
                    ].map(t => `<span class="tag-pill">${t}</span>`).join('');
                }

                const metaContainer = document.getElementById('meta-list');
                const metaFields = [
                    { key: 'fachliche_id', label: 'Fachliche ID' },
                    { key: 'guid', label: 'GUID' },
                    { key: 'termdat', label: 'TERMDAT' },
                    { key: 'fachbereich', label: 'Fachbereich' },
                    { key: 'system', label: 'Führendes System' },
                    { key: 'klassifizierung', label: 'Klassifizierung' },
                    { key: 'personenbezogen', label: 'Personenbezogene Daten' },
                    { key: 'kommentar', label: 'Kommentar' },
                    { key: 'version', label: 'Version' }
                ];

                if(metaContainer) {
                    if(item.meta) {
                        metaContainer.innerHTML = metaFields.map(field => {
                            const val = item.meta[field.key] || '-';
                            let displayVal = val;

                            if (['klassifizierung', 'personenbezogen', 'fachliche_id'].includes(field.key) && val !== '-') {
                                displayVal = `<span class="tag-pill">${val}</span>`;
                            }
                            
                            // Check for links within meta-data and color them blue
                            if (field.key === 'termdat' && typeof val === 'string' && val.startsWith('http')) {
                                // Important: We specifically DO NOT use the color here, as the CSS selector handles it.
                                displayVal = `<a href="${val}" target="_blank" style="text-decoration:underline;">${val}</a>`;
                            }

                            return `
                                <div class="meta-row">
                                    <div class="meta-key">${field.label}</div>
                                    <div class="meta-val">${displayVal}</div>
                                </div>
                            `;
                        }).join('');
                    } else { 
                        metaContainer.innerHTML = '<div class="meta-row">Keine Metadaten</div>'; 
                    }
                }


                const stdContainer = document.getElementById('standards-list');
                if (stdContainer) {
                    if (item.standards && item.standards.length > 0) {
                        stdContainer.innerHTML = item.standards.map(s => `
                            <div class="meta-row">
                                <div class="meta-key">${s.name}</div>
                                <div class="meta-val">${s.value}</div>
                            </div>
                        `).join('');
                    } else { stdContainer.innerHTML = '<div class="meta-row">Keine Standards definiert</div>'; }
                }

                const attrBody = document.getElementById('attr-body');
                if (attrBody) {
                    if (item.attributes && item.attributes.length > 0) {
                        attrBody.innerHTML = item.attributes.map(a => {
                            let keyBadge = a.key === '-' ? '-' : `<span class="tag-pill" title="Schlüsseltyp: ${a.key}">${a.key}</span>`;
                            let listBadge = a.list === '-' ? '-' : `<span class="tag-pill" title="Werteliste: ${a.list}">${a.list}</span>`;
                            
                            return `
                                <tr>
                                    <td>${a.name}</td>
                                    <td><span class="tag-pill">${a.format}</span></td>
                                    <td>${keyBadge}</td>
                                    <td>${listBadge}</td>
                                    <td>${a.desc}</td>
                                </tr>
                            `;
                        }).join('');
                    } else { attrBody.innerHTML = '<tr><td colspan="5">Keine Attribute definiert</td></tr>'; }
                }
            }

            // Initialisierung aufrufen
            init();

            // Expose ONLY necessary functions globally for HTML calls/DOM manipulation
            window.navigate = navigate;
            window.switchView = switchView; 
        })();
    </script>
</body>
</html>
